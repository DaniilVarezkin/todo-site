/*!*  filename: sf-ribbon.min.js 
*     version : 29.2.10 
*     Copyright Syncfusion Inc. 2001 - 2025. All rights reserved. 
*     Use of this code is subject to the terms of our license.
*     A copy of the current license can be obtained at any time by e-mailing 
*     licensing@syncfusion.com. Any infringement will be prosecuted under 
*     applicable laws. 
*/
(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{"./bundles/sf-ribbon.js":function(e,t,i){"use strict";i.r(t);i("./modules/sf-ribbon.js")},"./modules/sf-ribbon.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sfBlazor=window.sfBlazor||{},window.sfBlazor.Ribbon=function(){"use strict";var e,t,n;function r(e,t){for(var i=0;i<e.length;i++)if(t(e[parseInt(i.toString(),10)],i))return i;return-1}function o(e,t,i){for(var n=0;n<e.groups.length;n++)for(var r=e.groups[parseInt(n.toString(),10)],o=0;o<r.collections.length;o++)for(var s=r.collections[parseInt(o.toString(),10)],a=0;a<s.items.length;a++){var l=s.items[parseInt(a.toString(),10)];if(t&&l.id===t||i&&l.type===i)return{item:l,collection:s,group:r,groupIndex:n,collectionIndex:o,itemIndex:a}}return null}!function(e){e[e.Large=4]="Large",e[e.Medium=2]="Medium",e[e.Small=1]="Small"}(e||(e={})),function(e){e[e.Classic=4]="Classic",e[e.Simplified=2]="Simplified",e[e.Overflow=1]="Overflow",e[e.Auto=7]="Auto"}(t||(t={})),function(e){e.Button="Button",e.CheckBox="CheckBox",e.ColorPicker="ColorPicker",e.ComboBox="ComboBox",e.DropDown="DropDown",e.SplitButton="SplitButton",e.GroupButton="GroupButton",e.Gallery="Gallery",e.Template="Template"}(n||(n={}));var s=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i((function(t){t(e.value)})).then(s,a)}l((n=n.apply(e,t||[])).next())}))},a=function(e,t){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},l=function(){function n(e){window.sfBlazor=window.sfBlazor,this.resizeTimer=null,this.updateContext(e),window.sfBlazor.setCompInstance(this),this.keyConfigs={leftarrow:"leftarrow",rightarrow:"rightarrow",tab:"tab",shiftTab:"shift+tab"},this.initialize()}return n.prototype.updateContext=function(e){sf.base.extend(this,this,e),this.keyTipElements=Object.assign({},this.directKeyTips,this.tabIndexBasedKeyTips)},n.prototype.initialize=function(){this.wireEvents(),this.wireKeyboardEvent(),this.currentControlIndex=0,this.galleryItemsIndex=0},n.prototype.wireEvents=function(){sf.base.EventHandler.add(window,"resize",this.debounceHandler,this),sf.base.EventHandler.add(document.body,"keydown",this.keytipActionHandler,this),sf.base.EventHandler.add(document,"mousedown",this.mouseEventHandler,this),sf.base.EventHandler.add(document,"scroll",this.mouseEventHandler,this)},n.prototype.wireKeyboardEvent=function(){this.keyboardModuleRibbon=new sf.base.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},n.prototype.unWireEvents=function(){sf.base.EventHandler.remove(window,"resize",this.debounceHandler),sf.base.EventHandler.remove(document.body,"keydown",this.keytipActionHandler),sf.base.EventHandler.remove(document,"mousedown",this.mouseEventHandler),sf.base.EventHandler.remove(document,"scroll",this.mouseEventHandler)},n.prototype.mouseEventHandler=function(){this.enableKeyTips&&this.removeKeytip()},n.prototype.debounceHandler=function(){var e=this;clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout((function(){return s(e,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.resizeHandler()];case 1:return e.sent(),[2]}}))}))}),100)},n.prototype.resizeHandler=function(){return s(this,void 0,void 0,(function(){var e,t;return a(this,(function(i){switch(i.label){case 0:return(e=this.element.querySelector("#"+this.tab.id+"_content"))?[4,this.checkOverflow(e)]:[3,2];case 1:i.sent(),i.label=2;case 2:return this.scrollModule&&(t=this.element.querySelector(".e-hscroll-bar"),this.scrollModule.scrollStep=t.offsetWidth),this.enableKeyTips&&this.removeKeytip(),[2]}}))}))},n.prototype.updateServerLoadingState=function(e){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.dotNetRef.invokeMethodAsync("UpdateLoadingState",e)];case 1:return t.sent(),e&&this.handleSkeletonOverflow(),[2]}}))}))},n.prototype.handleSkeletonOverflow=function(){var e=this.element.querySelector("#"+this.tab.id+"_content");if(e){var t=this.element.querySelectorAll(".e-ribbon-skeleton-container"),i=e.closest(".e-content").clientWidth,n=20+("simplified"===this.activeLayout.toLowerCase()?16:30),r=0;t.forEach((function(e){var t=e.offsetWidth+n;r+t<=i?(e.classList.remove("e-ribbon-skeleton-hidden"),r+=t):e.classList.add("e-ribbon-skeleton-hidden")}))}},n.prototype.bindOrUnBindClickEventOnOverflowTarget=function(e){var t=e.shouldRemoveListener;this.dropDownPopupId=e.popupId,this.dropDownTargetId=e.targetId,t?(sf.base.EventHandler.remove(document,"click",this.handleDropdownPopupClosingState),this.removeKeytip("Escape")):sf.base.EventHandler.add(document,"click",this.handleDropdownPopupClosingState,this)},n.prototype.handleDropdownPopupClosingState=function(e){return s(this,void 0,void 0,(function(){var t,i,n,r;return a(this,(function(o){switch(o.label){case 0:return(t=document.querySelector("[dataid='"+this.dropDownPopupId+"']"))?(i=e.target.closest("#"+this.dropDownTargetId),n=e.target.closest("#"+this.element.id+"_tab_sim_ovrl_overflow"),r=t.classList.contains("e-ribbon-overall-of-btn")&&t.classList.contains("e-dropdown-popup"),t.contains(e.target)||i||r&&(!r||n)?[3,2]:(sf.base.EventHandler.remove(document,"click",this.handleDropdownPopupClosingState),[4,this.dotNetRef.invokeMethodAsync("UpdateDropdownPopupClosingState",this.dropDownTargetId)])):[2];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))},n.prototype.keytipActionHandler=function(e){if(this.enableKeyTips){var t=!1,i=e.key;if(e.altKey&&"Meta"===e.key)if(document.querySelectorAll(".e-ribbon .e-dropdown-btn.e-active, .e-ribbon-group-overflow-ddb .e-dropdown-btn.e-active").length)this.removeKeytip();else if(this.isKeytipOpen)this.removeKeytip();else{var n=document.querySelector(".e-ribbon-backstage-popup");n&&n.classList.contains("e-popup-open")&&this.hideBackstagePopup(),this.createKeytip("tab")}else if("Escape"===e.key||"Tab"===e.key||"ArrowLeft"===e.key||"ArrowUp"===e.key||"ArrowRight"===e.key||"ArrowDown"===e.key)this.removeKeytip(e.key);else{var r=document.querySelectorAll(".e-ribbon-keytip");if(r){for(var o=0;o<r.length;o++){if(r[parseInt(o.toString(),10)].innerHTML.toLowerCase()===i){t=!0,this.keytipPress(i);break}}t||this.checkKeyTipPresent(i,this.keysPress.length)}}}},n.prototype.checkKeyTipPresent=function(e,t){for(var i=document.querySelectorAll(".e-ribbon-keytip"),n=0;n<i.length;n++){var r=i[parseInt(n.toString(),10)];if(r.innerHTML.length>1&&r.innerHTML[parseInt(t.toString(),10)].toLowerCase()===e){this.keysPress+=e,this.keytipPress(this.keysPress);for(var o=document.querySelectorAll(".e-ribbon-keytip"),s=0;s<o.length;s++){var a=o[parseInt(s.toString(),10)];a.innerHTML[0].toLowerCase()!==e&&""!==e&&sf.base.remove(a)}break}}},n.prototype.createKeytip=function(e){var t,i=this;if(this.keyTipElements)if("tab"===e){for(var n=0;n<this.tabsLength;n++){var r=this.keyTipElements[parseInt(n.toString(),10)];r&&r.tab&&(t=r.tab,this.createKeyTipElement(t[0].id,t[0].keyTip,"tab","center","bottom",!0))}for(var o=0,s=["filemenu","backstage","collapse","taboverflow"];o<s.length;o++){var a=s[o],l=this.keyTipElements[""+a];l&&(t=l,this.createKeyTipElement(t[0].id,t[0].keyTip,a))}}else if("popupitem"===e){if((S=this.keyTipElements[this.selectedTab])&&S.popupitem){var c=S.popupitem,u=Object.keys(c);for(n=0;n<u.length;n++){var p=c[parseInt(n.toString(),10)];(w=document.querySelector(".e-dropdown-popup #"+p.id))&&this.createKeyTipElement(p.id,p.keyTip,"popupitem","left","top",!1,!0)}}}else if("backstageMenu"===e){var d=this.keyTipElements.backstageMenu;if(d){var h=Object.keys(d),f=function(e){var t=d[parseInt(e.toString(),10)];setTimeout((function(){i.createKeyTipElement(t.id,t.keyTip,"backstageMenu","left","center")}),500)};for(n=0;n<h.length;n++)f(n)}}else if("grpoverflowpopup"===e&&"Classic"===this.activeLayout){if((S=this.keyTipElements[this.selectedTab])&&S.grpoverflowpopup&&this.calculateItemPosition(e),S&&S.launcher){var b=S.launcher,g=Object.keys(b);for(n=0;n<g.length;n++){var m=b[parseInt(n.toString(),10)];this.createKeyTipElement(m.id,m.keyTip,"launcher","center","bottom",!1,!0)}}}else if(this.calculateItemPosition(e),"Classic"===this.activeLayout)for(var y=0,v=["launcher","grpoverflow"];y<v.length;y++){var S;a=v[y];if((S=this.keyTipElements[this.selectedTab])&&S[""+a]){var I=S[""+a],k=Object.keys(I);for(n=0;n<k.length;n++){var w=I[parseInt(n.toString(),10)];this.createKeyTipElement(w.id,w.keyTip,a)}}}else if("Simplified"===this.activeLayout){var C=this.keyTipElements.overflowbtn;C&&this.createKeyTipElement(C[0].id,C[0].keyTip,"overflowbtn");var x=this.keyTipElements[this.selectedTab].grpofbtn;if(x){var T=Object.keys(x);for(n=0;n<T.length;n++){w=x[parseInt(n.toString(),10)];this.createKeyTipElement(w.id,w.keyTip,"grpofbtn")}}}},n.prototype.calculateItemPosition=function(e,t,i){var n,r;void 0===t&&(t=!1);var s=parseInt(this.selectedTab.toString(),10),a=this.keyTipElements[""+s][""+e];if(a)for(var l=Object.keys(a),c=0;c<l.length;c++){var u=a[parseInt(c.toString(),10)];if(t&&u.keyTip===i||!t){var p=u.id;-1!==p.indexOf("_grpbtn")&&(p=p.replace(/_grpbtn\d+/,""));var d=o(this.tab,p);if(d){var h="Column"===d.group.orientation&&d.collection.items.length>1&&"Simplified"!==this.activeLayout,f="Row"===d.group.orientation&&d.group.collections.length>1&&"Simplified"!==this.activeLayout;if(h)switch(d.itemIndex){case 0:n="center",r="top";break;case 1:n="center",r="center";break;default:n="center",r="bottom"}else f&&(n="center",r=0===d.collectionIndex?"top":"bottom")}"item"===e?this.createKeyTipElement(a[parseInt(c.toString(),10)].id,a[parseInt(c.toString(),10)].keyTip,e,n,r):this.createKeyTipElement(a[parseInt(c.toString(),10)].id,a[parseInt(c.toString(),10)].keyTip,e,n,r,!1,!0)}}},n.prototype.createKeyTipElement=function(e,t,i,n,r,o,s){void 0===n&&(n="center"),void 0===r&&(r="bottom"),void 0===o&&(o=!1),void 0===s&&(s=!1);var a,l,c=s?".e-dropdown-popup #"+e:"#"+e,u=document.querySelector(c),p=document.querySelector("#"+e+"_keytip"),d=!1;if(o&&(u=document.querySelector("#"+e+"_header")),u){s&&document.querySelector(".e-dropdown-popup #"+e)&&(d=!0,l=".e-dropdown-popup #"+e),o&&s&&u.closest(".e-toolbar-pop")&&(d=!0);var h=u.closest(".e-split-btn-wrapper");if(h)a=h.closest(".e-ribbon-item").id;else{var f=u.closest(".e-colorpicker-wrapper");f&&(a=f.closest(".e-ribbon-item").id)}}if(!p&&(u&&u.offsetParent||o&&s)&&(s&&d||!s)){var b=sf.base.createElement("div",{className:"e-ribbon-keytip",id:e+"_keytip",attrs:{role:"dialog","aria-label":"ribbon-keytip"}});document.body.append(b);var g="#"+(o?e+"_header":a||e);new sf.popups.Popup(b,{relateTo:l||g,content:t,collision:{X:"fit",Y:"flip"},targetType:"relative",position:{X:n,Y:r},enableRtl:this.enableRtl,actionOnScroll:"hide"}).show(),this.calculateKeyTipPosition(u,b,i,r),this.isKeytipOpen=!0}},n.prototype.calculateKeyTipPosition=function(e,t,i,n){var r=e.getBoundingClientRect();"backstageMenu"===i?(t.style.top=r.top+t.offsetHeight/2+"px",t.style.left=r.left+e.offsetWidth/5+"px"):"popupitem"!==i&&(t.style.left=r.left+(r.width-t.offsetWidth)/2+"px"),"filemenu"===i||"backstage"===i?t.style.top=r.top+(e.offsetHeight-e.offsetHeight/3+t.offsetHeight/6)+"px":"item"===i&&"top"===n&&(t.style.top=r.top-e.offsetHeight/2+"px")},n.prototype.keytipPress=function(e,t){void 0===t&&(t=!1),this.isKeytipPresent=!1;for(var i=Object.keys(this.keyTipElements).length,n=0;n<i&&!this.isKeytipPresent;n++){var r=this.keyTipElements[parseInt(n.toString(),10)];if(r)for(var o=Object.keys(r),s=0;s<o.length&&!this.isKeytipPresent;s++)for(var a=r[o[parseInt(s.toString(),10)]],l=0;l<Object.keys(a).length&&!this.isKeytipPresent;l++){var c=a[""+l];if(e.toUpperCase()===c.keyTip)(document.querySelector("#"+c.id+"_keytip")||t)&&(this.isKeytipPresent=!0,this.removeKeytip(),this.handleKeyTipPressActions(c,n,l,t,a))}else this.keyTipElements&&this.commonItemsKeyTipPress(e,Object.keys(this.keyTipElements)[parseInt(n.toString(),10)],t)}},n.prototype.commonItemsKeyTipPress=function(e,t,i){var n=this,r=this.keyTipElements[""+t],o=!1,s=null;if(r)if("backstageMenu"===t)for(var a=0;a<Object.keys(r).length;a++){var l;if((l=r[""+a]).keyTip===e.toUpperCase()&&(s=document.querySelector("#"+l.id),document.querySelector("#"+s.id+"_keytip")||i)){o=!0,i&&document.querySelector(".e-ribbon-backstage-popup").classList.contains("e-popup-close")&&this.element.querySelector(".e-ribbon-backstage").click();break}}else(l=r[0])&&l.keyTip===e.toUpperCase()&&(s=document.querySelector("#"+l.id),(document.querySelector("#"+l.id+"_keytip")||i)&&(o=!0));if(o){if(this.removeKeytip(),this.isKeytipPresent=!0,!s)return;s.click(),s.focus(),"backstage"===t?this.createKeytip("backstageMenu"):"overflowbtn"===t?(this.isKeytipPopupOpen=!0,this.createKeytip("popupitem")):"taboverflow"===t&&setTimeout((function(){for(var e=0;e<Object.keys(n.keyTipElements).length;e++){var t=n.keyTipElements[parseInt(e.toString(),10)].tab;t&&t[0]&&n.createKeyTipElement(t[0].id,t[0].keyTip,"tab","center","bottom",!0,!0)}}),600)}},n.prototype.handleKeyTipPressActions=function(e,t,i,n,r){"tab"===e.type?this.handleTabKeyTipPressAction(e,t):"item"===e.type||"grpoverflowpopup"===e.type||"popupitem"===e.type?this.handleItemKeyPressActions(e,n,r,i):"grpoverflow"!==e.type&&"grpofbtn"!==e.type&&"launcher"!==e.type||this.handleOverflowKeyTipPressActions(e,n,r,i)},n.prototype.handleTabKeyTipPressAction=function(e,t){var i=this;if(t!==this.selectedTab){var n=document.querySelector("#"+e.id+"_header");n&&n.click(),setTimeout((function(){var e=i.element.querySelector(".e-nav-active");e&&e.click(),i.createKeytip("item")}),1e3)}else this.createKeytip("item")},n.prototype.handleItemKeyPressActions=function(e,t,i,n){var r=document.getElementById(e.id);if(r&&r.classList.contains("e-ribbon-group-button"))r.click();else{var s=void 0;if(-1!==e.id.indexOf("_popupButton")){var a=e.id.replace(/_popupButton/g,"");s=o(this.tab,a)}else s=o(this.tab,e.id);t&&!t||this.clickItems(s,i,n,!1,t)}},n.prototype.handleOverflowKeyTipPressActions=function(e,t,i,n){var r=document.querySelector("#"+e.id);if(this.removeKeytip(),r){var o=e.id;if(t){if(-1!==e.id.indexOf("_launcher")||-1!==e.id.indexOf("_sim_grp_overflow")||-1!==e.id.indexOf("_overflow_dropdown")){o=e.id.replace(/_launcher|_sim_grp_overflow|_overflow_dropdown/g,"");var s=function(e,t){for(var i=0;i<e.groups.length;i++){var n=e.groups[parseInt(i.toString(),10)];if(n.id===t)return{group:n,groupIndex:i}}return null}(this.tab,o);this.clickItems(s,i,n,!0,t,r)}}else this.clickItems(null,i,n,!0,t,r)}},n.prototype.clickItems=function(e,t,i,n,r,o){var s=this,a=t[""+i].id;if(n)o&&o.click(),"launcher"!==t[""+i].type&&(this.isKeytipPopupOpen=!0,setTimeout((function(){"grpoverflow"===t[""+i].type?s.createKeytip("grpoverflowpopup"):s.createKeytip("popupitem")}),"grpoverflow"===t[""+i].type?100:600));else{document.querySelector("#"+a)&&r&&this.handleItemClickThroughMethod(e,a);var l=document.querySelector(".e-dropdown-popup #"+a)?document.querySelector(".e-dropdown-popup"):this.element;switch(e.item.type){case"Button":case"DropDown":case"CheckBox":var c=l.querySelector("#"+a);this.isInteractableElement(c)&&c.click();break;case"SplitButton":c=l.querySelector("#"+a+"_dropdownbutton");this.isInteractableElement(c)&&c.click();break;case"ColorPicker":var u=l.querySelector("#"+a+"_container");if(this.isInteractableElement(u))(c=u.querySelectorAll("button")[1]).click();break;case"ComboBox":var p=l.querySelector("#"+a);this.isInteractableElement(p)&&setTimeout((function(){p.focus()}),100);break;case"Gallery":var d=l.querySelector("#"+a);this.isInteractableElement(d)&&d.click();break;case"Template":var h=l.querySelector("#"+a);this.isInteractableElement(h)&&h.focus();break;case"GroupButton":var f=l.querySelector("#"+a);this.isInteractableElement(f)&&(f.click(),setTimeout((function(){e.item.groupButtonSettings.items.forEach((function(e,t){e.keyTip&&s.createKeyTipElement(a+"_grpbtn"+t,e.keyTip,"item")}))}),600))}}},n.prototype.isInteractableElement=function(e){return e&&!e.closest(".e-ribbon-item").classList.contains("e-disabled")},n.prototype.handleItemClickThroughMethod=function(e,t){var i=document.querySelector("#"+t);"Simplified"===this.activeLayout?i.closest("#"+e.group.id+"_sim_grp_overflow-popup").classList.contains("e-popup-close")?document.querySelector("#"+e.group.id+"_sim_grp_overflow").click():i.closest("#"+this.tab.id+"_sim_ovrl_overflow-popup").classList.contains("e-popup-close")&&document.querySelector("#"+this.tab.id+"_sim_ovrl_overflow").click():i.closest("#"+e.group.id+"_overflow_dropdown-popup").classList.contains("e-popup-close")&&document.querySelector("#"+e.group.id+"_overflow_dropdown").click()},n.prototype.removeKeytip=function(e){var t=this,i=document.querySelectorAll(".e-ribbon-keytip"),n=!1;this.keysPress="";for(var o=function(e,t){return r(e,(function(e){return e.id+"_keytip"===t}))},s=0;s<i.length;s++){var a=i[parseInt(s.toString(),10)];if("Escape"===e&&this.keyTipElements&&this.keyTipElements[this.selectedTab]){for(var l=this.keyTipElements[this.selectedTab],c=0;c<Object.keys(l).length;c++){var u=Object.keys(l)[parseInt(c.toString(),10)];if(-1!==o(d=l[""+u],a.id)){if("item"===u&&!this.isKeytipPopupOpen||"grpoverflow"===u&&"Classic"===this.activeLayout){this.createKeytip("tab"),e="",n=!0;break}if(this.isKeytipPopupOpen&&("popupitem"===u&&"Simplified"===this.activeLayout||"grpoverflowpopup"===u&&"Classic"===this.activeLayout)){this.createKeytip("item"),e="",n=!0;break}}}for(var p=0;p<Object.keys(this.keyTipElements).length;p++)if(this.keyTipElements[parseInt(p.toString(),10)]){var d=this.keyTipElements[parseInt(p.toString(),10)].tab;for(c=0;c<Object.keys(d).length;c++)if(a.id===d[0].id+"_keytip"&&document.querySelector("#"+d[0].id+"_header").closest(".e-toolbar-pop")){this.element.querySelector(".e-nav-active").click(),setTimeout((function(){t.createKeytip("tab")}),600),e="",n=!0;break}if(n)break}if(!n&&this.keyTipElements.backstageMenu)-1!==o(this.keyTipElements.backstageMenu,a.id)&&(this.createKeytip("tab"),e="",n=!0)}a&&sf.base.remove(a)}this.isKeytipPopupOpen=!1,n||(this.isKeytipOpen=!1)},n.prototype.showHideKeyTips=function(e){var t=e.keyAction,i=e.showKeytip;this.enableKeyTips&&(i?t?this.keytipPress(t,!0):this.createKeytip("tab"):this.removeKeytip())},n.prototype.bindOrUnBindKeyDownEventOnOverflowTarget=function(e){var t=this,i=e.shouldRemoveListener;if(e.isFilemenu)this.setInitialFocusOnFilemenu(i);else{var n=document.querySelector(".e-ribbon-overflow-target");n&&(n.onkeydown=i?null:function(e){t.upDownKeyHandler(e,n)})}},n.prototype.setInitialFocusOnFilemenu=function(e){var t=document.querySelector(".e-ribbon-menu .e-menu"),i=this.element.querySelector("#"+this.element.id+"_filemenu"),n=e?i:t;n&&n.focus()},n.prototype.keyActionHandler=function(e){"Tab"!==e.key||e.target.classList.contains("e-tab-wrap")||e.target.classList.contains("e-combobox")||e.preventDefault();var t=this.element.querySelector("#"+this.tab.id+"_content");if(t){var i,n=Array.prototype.slice.call(t.querySelectorAll(".e-control")),r=Array.prototype.slice.call(t.querySelectorAll(".e-ribbon-template")),o=Array.prototype.slice.call(t.querySelectorAll(".e-ribbon-gallery-item")),s=n.concat(r,o),a=t.querySelectorAll(".e-combobox");if(a)for(var l=0;l<a.length;l++)a[parseInt(l.toString(),10)].closest(".e-input-focus")&&(i=a[parseInt(l.toString(),10)]);if(i)for(l=0;l<s.length;l++)s[parseInt(l.toString(),10)].classList.contains("e-combobox")&&s[parseInt(l.toString(),10)].closest(".e-input-focus")&&(this.currentControlIndex=l);if(0===this.currentControlIndex)for(var c=s[this.currentControlIndex].closest(".e-ribbon-item");c&&c.classList.contains("e-disabled");)this.currentControlIndex++,c=s[this.currentControlIndex].closest(".e-ribbon-item");if(e.target.classList.contains("e-control")||e.target.classList.contains("e-ribbon-launcher-icon")||e.target.classList.contains("e-ribbon-collapse-btn")||e.target.classList.contains("e-ribbon-last-item")||e.target.classList.contains("e-ribbon-first-item")||e.target.classList.contains("e-ribbon-group-of-btn")||e.target.classList.contains("e-ribbon-overall-of-btn")||e.target.classList.contains("e-ribbon-template")||e.target.classList.contains("e-ribbon-gallery-item"))switch(e.action){case"rightarrow":this.handleItemsNavigation(e,!this.enableRtl,s);break;case"leftarrow":this.handleItemsNavigation(e,this.enableRtl,s);break;case"tab":e.target.classList.contains("e-combobox")&&this.currentControlIndex<s.length-1&&this.currentControlIndex++;break;case"shiftTab":e.target.classList.contains("e-combobox")?this.currentControlIndex>0&&this.currentControlIndex--:(this.element.querySelector(".e-toolbar-item.e-active").querySelector(".e-tab-wrap").focus(),this.currentControlIndex=0)}}},n.prototype.handleItemsNavigation=function(e,t,i){var n,r;if(t?this.currentControlIndex<i.length-1&&i[this.currentControlIndex+1].classList.contains("e-colorpicker")&&this.currentControlIndex++:this.currentControlIndex>0&&i[this.currentControlIndex-1].classList.contains("e-colorpicker")&&this.currentControlIndex--,!t&&this.currentControlIndex>0||t&&this.currentControlIndex<i.length-1){if(!e.target.classList.contains("e-combobox")&&(e.target.classList.contains("e-control")||e.target.classList.contains("e-ribbon-template")||e.target.classList.contains("e-ribbon-gallery-item"))&&!e.target.classList.contains("e-ribbon-last-item")){if(t)this.currentControlIndex++;else{var o=i[parseInt(this.currentControlIndex.toString(),10)].closest(".e-ribbon-group-container");o&&(r=o.getAttribute("id")),this.currentControlIndex--}for(var s=i[this.currentControlIndex].closest(".e-ribbon-item");s&&s.classList.contains("e-disabled");){if((t&&this.currentControlIndex===i.length-1||!t&&0===this.currentControlIndex)&&i[this.currentControlIndex].closest(".e-ribbon-item").classList.contains("e-disabled")){this.element.querySelector(".e-ribbon-collapse-btn").focus();break}t?this.currentControlIndex++:this.currentControlIndex--,s=i[this.currentControlIndex].closest(".e-ribbon-item")}if(i[parseInt(this.currentControlIndex.toString(),10)].focus(),"Classic"===this.activeLayout)if(n=i[parseInt(this.currentControlIndex.toString(),10)].closest(".e-ribbon-group-container"),t){var a=void 0;if(n&&(a=n.querySelector(".e-ribbon-launcher-icon")),a){var l=n.querySelectorAll(".e-ribbon-item"),c=l[l.length-1].querySelector(".e-control");c&&c.classList.add("e-ribbon-last-item")}}else{if(n)if(r!==n.getAttribute("id"))(a=n.querySelector(".e-ribbon-launcher-icon"))&&i[parseInt((this.currentControlIndex+1).toString(),10)].classList.add("e-ribbon-first-item")}else i[parseInt(this.currentControlIndex.toString(),10)].classList.contains("e-ribbon-first-item")?i[parseInt(this.currentControlIndex.toString(),10)].classList.remove("e-ribbon-first-item"):i[parseInt(this.currentControlIndex.toString(),10)].classList.contains("e-ribbon-last-item")&&i[parseInt(this.currentControlIndex.toString(),10)].classList.remove("e-ribbon-last-item")}}else if("Classic"===this.activeLayout&&this.element.querySelector(".e-ribbon-collapse-btn").focus(),"Simplified"===this.activeLayout){var u=this.element.querySelector(".e-ribbon-overall-of-btn");t&&u&&!u.classList.contains("e-ribbon-hide")?u.focus():this.element.querySelector(".e-ribbon-collapse-btn").focus()}(e.target.classList.contains("e-ribbon-last-item")&&(t?(n=i[parseInt(this.currentControlIndex.toString(),10)].closest(".e-ribbon-group-container")).querySelector(".e-ribbon-launcher-icon").focus():(this.currentControlIndex--,i[parseInt(this.currentControlIndex.toString(),10)].focus())),!t&&e.target.classList.contains("e-ribbon-first-item"))&&((a=(n=i[parseInt((this.currentControlIndex-1).toString(),10)].closest(".e-ribbon-group-container")).querySelector(".e-ribbon-launcher-icon"))&&n.querySelector(".e-ribbon-launcher-icon").focus());if(e.target.classList.contains("e-ribbon-launcher-icon")&&(t?(this.currentControlIndex++,i[parseInt(this.currentControlIndex.toString(),10)].focus(),i[parseInt((this.currentControlIndex-1).toString(),10)].classList.contains("e-ribbon-last-item")&&i[parseInt((this.currentControlIndex-1).toString(),10)].classList.remove("e-ribbon-last-item")):(this.currentControlIndex,i[parseInt(this.currentControlIndex.toString(),10)].focus())),e.target.classList.contains("e-ribbon-collapse-btn"))if(t){this.currentControlIndex=0;for(var p=i[this.currentControlIndex].closest(".e-ribbon-item");p&&p.classList.contains("e-disabled");)this.currentControlIndex++,p=i[this.currentControlIndex].closest(".e-ribbon-item");i[parseInt(this.currentControlIndex.toString(),10)].focus()}else{if((u=this.element.querySelector(".e-ribbon-overall-of-btn"))&&!u.classList.contains("e-ribbon-hide"))u.focus();else{this.currentControlIndex=i.length-1;for(p=i[this.currentControlIndex].closest(".e-ribbon-item");p&&p.classList.contains("e-disabled");)this.currentControlIndex--,p=i[this.currentControlIndex].closest(".e-ribbon-item");i[parseInt(this.currentControlIndex.toString(),10)].focus()}}"Simplified"===this.activeLayout&&e.target.classList.contains("e-ribbon-overall-of-btn")&&(t?this.element.querySelector(".e-ribbon-collapse-btn").focus():(this.currentControlIndex=i.length-1,i[parseInt(this.currentControlIndex.toString(),10)].focus()))},n.prototype.upDownKeyHandler=function(e,t){var i=t.getElementsByClassName("e-ribbon-item");this.itemIndex=!this.itemIndex||this.itemIndex<0?0:this.itemIndex;var n=i[this.itemIndex].querySelector(".e-control").classList.contains("e-combobox")?i[this.itemIndex].querySelector(".e-combobox"):null,r=function(e){return"ArrowDown"===e||"ArrowUp"===e||"Tab"===e};n&&!r(e.key)||("ArrowDown"===e.key||!e.shiftKey&&"Tab"===e.key?this.handleNavigation(i,!0,e,n):("ArrowUp"===e.key||e.shiftKey&&"Tab"===e.key)&&this.handleNavigation(i,!1,e,n)),t.setAttribute("index",this.itemIndex.toString());var o=parseInt(t.getAttribute("index"),10),s=i[parseInt(o.toString(),10)].querySelector(".e-control").getAttribute("data-control");(r(e.key)||" "===e.key)&&this.handleControlFocus(e,i,o,s),"SplitButton"!==s||"ArrowRight"!==e.key&&"ArrowLeft"!==e.key||this.handleSplitButtonNavigation(e,i,o),"Enter"===e.key&&(this.itemIndex=-1)},n.prototype.handleNavigation=function(e,t,i,n){var r=e.length-1;(t?this.itemIndex>=r:this.itemIndex<=0)||this.itemIndex<0?this.itemIndex=t?0:r:this.itemIndex+=t?1:-1;var o=e[this.itemIndex].closest(".e-ribbon-item");this.findDisabledItem(o,e,t);var s=e[this.itemIndex].querySelector(".e-ribbon-template");(n||"Tab"===i.key&&i.shiftKey===!t)&&(i.preventDefault(),this.controlElementFocus(e,this.itemIndex)),s&&s.focus()},n.prototype.handleControlFocus=function(e,t,i,n){if("ColorPicker"===n?("Tab"===e.key&&e.preventDefault(),t[parseInt(i.toString(),10)].querySelector(".e-split-colorpicker").focus()):("Tab"===e.key&&e.preventDefault(),this.controlElementFocus(t,i))," "===e.key&&"CheckBox"===n){var r=t[parseInt(i.toString(),10)].querySelector(".e-control"),o=sf.base.getComponent(r,sf.buttons.CheckBox);this.itemIndex=-1,o.click()}},n.prototype.handleSplitButtonNavigation=function(e,t,i){var n=this.enableRtl?"ArrowRight"===e.key?".e-control":".e-dropdown-btn":"ArrowRight"===e.key?".e-dropdown-btn":".e-control";t[parseInt(i.toString(),10)].querySelector(n).focus()},n.prototype.controlElementFocus=function(e,t){var i=e[parseInt(t.toString(),10)].querySelector(".e-control");i&&i.focus()},n.prototype.findDisabledItem=function(e,t,i){for(;e&&e.classList.contains("e-disabled");)i?this.itemIndex===t.length-1&&t[this.itemIndex].closest(".e-ribbon-item").classList.contains("e-disabled")&&(this.itemIndex=-1):0===this.itemIndex&&t[this.itemIndex].closest(".e-ribbon-item").classList.contains("e-disabled")&&(this.itemIndex=t.length),i?this.itemIndex++:this.itemIndex--,e=t[this.itemIndex].closest(".e-ribbon-item")},n.prototype.handleGalleryPopupNavigation=function(e,t,i,n){var r=t.querySelectorAll(".e-ribbon-gallery-item");if(r.length)switch(e.key){case"Home":this.setGalleryFocus(r,0);break;case"End":this.setGalleryFocus(r,r.length-1);break;case"ArrowRight":case"ArrowDown":this.changeGalleryFocus(r,1);break;case"ArrowLeft":case"ArrowUp":this.changeGalleryFocus(r,-1);break;case"Enter":case"Space":case"Escape":this.hidePopup(n,i)}},n.prototype.setGalleryFocus=function(e,t){this.galleryItemsIndex=t,e[this.galleryItemsIndex].focus()},n.prototype.changeGalleryFocus=function(e,t){this.galleryItemsIndex=(this.galleryItemsIndex+t+e.length)%e.length,e[this.galleryItemsIndex].focus()},n.prototype.handleBackstageNavigation=function(e){var t=this,i="ArrowUp"===e.key,n="ArrowDown"===e.key;if((i||n)&&(e.preventDefault(),e.stopPropagation()),"Escape"!==e.code){var r=this.element.querySelector(".e-ribbon-backstage-popup"),o=r.querySelector(".e-ribbon-close-btn"),s=r.querySelectorAll(".e-menu-item");if(i||n){i&&this.menuIndex>0||n&&this.menuIndex<s.length-1&&!this.isCloseBtn?this.menuIndex=i?this.menuIndex-1:this.menuIndex+1:o&&!this.isCloseBtn?(requestAnimationFrame((function(){o.focus()})),this.isCloseBtn=!0):(this.menuIndex=i?s.length-1:0,this.isCloseBtn=!1);for(var a=0;a<s.length;a++)s[parseInt(a.toString(),10)].classList.remove("e-focused");this.isCloseBtn||(i&&s[this.menuIndex].classList.contains("e-separator")?this.menuIndex--:n&&s[this.menuIndex].classList.contains("e-separator")&&this.menuIndex++,requestAnimationFrame((function(){s[t.menuIndex].classList.add("e-focused"),s[t.menuIndex].focus()})))}}else this.hideBackstagePopup()},n.prototype.checkOverflow=function(e){return s(this,void 0,void 0,(function(){var t,i,n;return a(this,(function(r){switch(r.label){case 0:return this.destroyScroll(),t=e.closest(".e-content"),!(i=t.offsetWidth<e.offsetWidth)||this.scrollModule?[3,13]:[4,this.updateServerLoadingState(!0)];case 1:return r.sent(),"Classic"!==this.activeLayout?[3,7]:(n=!1,[4,this.checkGroupShrinking(t,e,!0)]);case 2:return!(n=r.sent())&&t.offsetWidth<e.offsetWidth?[4,this.checkGroupShrinking(t,e,!1)]:[3,4];case 3:n=r.sent(),r.label=4;case 4:return t.offsetWidth<e.offsetWidth?[4,this.createOverflowDropdown(t,e)]:[3,6];case 5:r.sent(),r.label=6;case 6:return[3,11];case 7:return[4,this.toggleDropdown()];case 8:return r.sent(),[4,this.checkSimplifiedItemShrinking(t,e)];case 9:return r.sent(),t.offsetWidth<e.offsetWidth?[4,this.createSimplifiedOverflow(t,e)]:[3,11];case 10:r.sent(),r.label=11;case 11:return t.offsetWidth<e.offsetWidth&&!this.scrollModule&&(this.scrollModule=new sf.navigations.HScroll({enableRtl:this.enableRtl},this.element.querySelector(".e-content"))),[4,this.updateServerLoadingState(!1)];case 12:return r.sent(),[3,29];case 13:return i?[3,29]:(this.destroyScroll(),this.isSizeReducedAtleastOnce?[4,this.updateServerLoadingState(!0)]:[3,15]);case 14:r.sent(),r.label=15;case 15:return"Classic"!==this.activeLayout?[3,21]:(n=!1,[4,this.removeOverflowDropdown(t,e,!1)]);case 16:return!(n=r.sent())&&t.offsetWidth>e.offsetWidth?[4,this.checkGroupExpanding(t,e,!0)]:[3,18];case 17:n=r.sent(),r.label=18;case 18:return!n&&t.offsetWidth>e.offsetWidth?[4,this.checkGroupExpanding(t,e,!1)]:[3,20];case 19:n=r.sent(),r.label=20;case 20:return[3,27];case 21:return[4,this.toggleDropdown()];case 22:return r.sent(),[4,this.removeSimplifiedOverflow(t,e)];case 23:return r.sent(),t.offsetWidth>e.offsetWidth?[4,this.checkSimplifiedItemExpanding(t,e)]:[3,25];case 24:return r.sent(),[3,27];case 25:return[4,this.checkOverflow(e)];case 26:r.sent(),r.label=27;case 27:return this.isSizeReducedAtleastOnce?[4,this.updateServerLoadingState(!1)]:[3,29];case 28:r.sent(),this.isSizeReducedAtleastOnce=!1,r.label=29;case 29:return[2]}}))}))},n.prototype.toggleDropdown=function(){return s(this,void 0,void 0,(function(){var e,t,i;return a(this,(function(n){switch(n.label){case 0:for(e=[],t=0;t<this.tab.groups.length;t++)(i=this.tab.groups[parseInt(t.toString(),10)]).isCollapsed&&e.push({groupId:i.id,itemId:null,value:!1,isItem:!1});return e.length>0?[4,this.dotNetRef.invokeMethodAsync("ToggleOverflowDropdownsInBulk",JSON.stringify(e))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},n.prototype.setItemSize=function(e,t){return s(this,void 0,void 0,(function(){var i;return a(this,(function(n){switch(n.label){case 0:return this.isSizeReducedAtleastOnce=!0,i=e.map((function(e){return e.id})),[4,this.dotNetRef.invokeMethodAsync("UpdateItemSize",i,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.checkGroupShrinking=function(e,t,i){return s(this,void 0,void 0,(function(){var n,r,o,s,l;return a(this,(function(a){switch(a.label){case 0:n=!0,r=!1,o=this.tab,s=o.groups.length-1,a.label=1;case 1:return n&&s>=0?i?[4,this.checkLargeToMedium(o,s,e,t)]:[3,3]:[3,7];case 2:return l=a.sent(),[3,5];case 3:return[4,this.checkMediumToSmall(o,s,e,t)];case 4:l=a.sent(),a.label=5;case 5:n=!(r=l)&&e.offsetWidth<t.offsetWidth,a.label=6;case 6:return s--,[3,1];case 7:return[2,r]}}))}))},n.prototype.checkGroupExpanding=function(e,t,i){return s(this,void 0,void 0,(function(){var n,r,o,s;return a(this,(function(a){switch(a.label){case 0:n=!1,r=this.tab,o=0,a.label=1;case 1:return!n&&o<r.groups.length?i?[4,this.checkSmallToMedium(r,o,e,t,!1,!0)]:[3,3]:[3,7];case 2:return s=a.sent(),[3,5];case 3:return[4,this.checkMediumToLarge(r,o,e,t,!1,!0)];case 4:s=a.sent(),a.label=5;case 5:n=s,a.label=6;case 6:return o++,[3,1];case 7:return[2,n]}}))}))},n.prototype.checkValidCollectionLength=function(e){for(var i=0,n=0;n<e.length;n++){for(var r=e[parseInt(n.toString(),10)].items,o=0;o<r.length;o++)if(r[parseInt(o.toString(),10)].displayOptions&t.Classic){i++;break}if(i>1)return!1}return 1===i},n.prototype.checkClassicCollection=function(e,i,n){for(var r=e[parseInt(i.toString(),10)].items,o=0;o<r.length;o++)if(r[parseInt(o.toString(),10)].displayOptions&t.Classic)return i;return i=n?i+1:i-1,n?i===e.length?i:this.checkClassicCollection(e,i,n):i<0?i:this.checkClassicCollection(e,i,n)},n.prototype.checkClassicItem=function(e,i,n){return e[parseInt(i.toString(),10)].displayOptions&t.Classic?i:(i=n?i+1:i-1,n?i===e.length?i:this.checkClassicItem(e,i,n):i<0?i:this.checkClassicItem(e,i,n))},n.prototype.checkLargeToMedium=function(i,n,r,o,l){return void 0===l&&(l=!1),s(this,void 0,void 0,(function(){var c,u,p,d,h,f,b,g,m,y=this;return a(this,(function(v){switch(v.label){case 0:if((c=i.groups[parseInt(n.toString(),10)]).isCollapsed&&!l)return[2,!1];if(u=function(e){return 1===e.items.length&&p(e.items[0])},p=function(t){return t.allowedSizes&e.Medium&&t.activeSize===e.Large},d=function(i,r){return s(y,void 0,void 0,(function(){var s,c,u,p,d,h;return a(this,(function(a){switch(a.label){case 0:return s=this.tab.groups[parseInt(n.toString(),10)].collections[0],c=[],u=[],l?[3,2]:[4,this.dotNetRef.invokeMethodAsync("CreateShrinkContainer",i.toString(),r.toString(),o.offsetWidth.toString(),s.id,null,!1)];case 1:a.sent(),a.label=2;case 2:for(d=function(i){var n=s.items[parseInt(i.toString(),10)];if(!(n.displayOptions&t.Classic))return"continue";n.activeSize=e.Medium,c.find((function(e){return e.id===n.id}))||(c.push(n),u.push(n.id),p=!0)},h=i;h<=r;h++)d(h);return p?[4,this.dotNetRef.invokeMethodAsync("UpdateShrinkable",!0,u,null)]:[3,5];case 3:return a.sent(),[4,this.setItemSize(c,e.Medium)];case 4:a.sent(),p=!1,a.label=5;case 5:return[2]}}))}))},h=function(t,i){return s(y,void 0,void 0,(function(){var r,s,c,u,p,d,h;return a(this,(function(a){switch(a.label){case 0:return r=this.tab.groups[parseInt(n.toString(),10)],s=[],c=[],u=[],l?[3,2]:[4,this.dotNetRef.invokeMethodAsync("CreateShrinkContainer",t.toString(),i.toString(),o.offsetWidth.toString(),null,r.id,!1)];case 1:a.sent(),a.label=2;case 2:for(d=function(t){var i=r.collections[parseInt(t.toString(),10)];i.items[0].activeSize=e.Medium,c.find((function(e){return e.id===i.id}))||u.push(i.id),s.find((function(e){return e.id===i.items[0].id}))||s.push(i.items[0]),p=!0},h=t;h<=i;h++)d(h);return p?[4,this.dotNetRef.invokeMethodAsync("UpdateShrinkable",!0,null,u)]:[3,5];case 3:return a.sent(),[4,this.setItemSize(s,e.Medium)];case 4:a.sent(),p=!1,a.label=5;case 5:return[2]}}))}))},"Column"!==c.orientation)return[3,9];b=c.collections.length-1,v.label=1;case 1:return b>0?(b=this.checkClassicCollection(c.collections,b,!1),(g=b-1)>=0&&u(c.collections[parseInt(b.toString(),10)])?(g=this.checkClassicCollection(c.collections,g,!1))>=0&&u(c.collections[parseInt(g.toString(),10)])?((m=g-1)>=0&&(m=this.checkClassicCollection(c.collections,m,!1)),m>=0&&u(c.collections[parseInt(m.toString(),10)])?[4,h(m,b)]:[3,3]):[3,6]:[3,7]):[3,8];case 2:return v.sent(),[3,5];case 3:return[4,h(g,b)];case 4:v.sent(),v.label=5;case 5:return b=m,!l&&r.offsetWidth>o.offsetWidth?[2,!0]:[3,7];case 6:b=g,v.label=7;case 7:return b--,[3,1];case 8:return[3,17];case 9:if(!this.checkValidCollectionLength(c.collections))return[3,17];f=c.collections[0],b=f.items.length-1,v.label=10;case 10:return b>0?(b=this.checkClassicItem(f.items,b,!1),(g=b-1)>=0&&p(f.items[parseInt(b.toString(),10)])?(g=this.checkClassicItem(f.items,g,!1))>=0&&p(f.items[parseInt(g.toString(),10)])?((m=g-1)>=0&&(m=this.checkClassicItem(f.items,m,!1)),m>=0&&p(f.items[parseInt(m.toString(),10)])?[4,d(m,b)]:[3,12]):[3,15]:[3,16]):[3,17];case 11:return v.sent(),[3,14];case 12:return[4,d(g,b)];case 13:v.sent(),v.label=14;case 14:return b=m,!l&&r.offsetWidth>o.offsetWidth?[2,!0]:[3,16];case 15:b=g,v.label=16;case 16:return b--,[3,10];case 17:return[2,!1]}}))}))},n.prototype.checkMediumToSmall=function(i,n,r,o,l){return void 0===l&&(l=!1),s(this,void 0,void 0,(function(){var c,u,p,d,h,f,b,g,m,y,v,S,I,k,w,C,x,T,L,q,A=this;return a(this,(function(E){switch(E.label){case 0:if((c=i.groups[parseInt(n.toString(),10)]).isCollapsed&&!l)return[2,!1];if(u=c.orientation,p=o.querySelector("#"+c.id),d=p.querySelectorAll(".e-ribbon-shrink"),h=[],b=function(t){return t.allowedSizes&e.Small&&t.activeSize===e.Medium},g=function(i,r,o,l){return void 0===l&&(l=null),s(A,void 0,void 0,(function(){var c,u,p=this;return a(this,(function(d){switch(d.label){case 0:return c=this.tab.groups[parseInt(n.toString(),10)].collections[parseInt(i.toString(),10)],[4,(u=function(i){return s(p,void 0,void 0,(function(){var n;return a(this,(function(r){return(n=c.items[parseInt(i.toString(),10)]).displayOptions&t.Classic&&(n.activeSize=e.Small,h.find((function(e){return e.id===n.id}))||(h.push(n),f=!0)),[2]}))}))})(r)];case 1:return d.sent(),l?[4,u(l)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,u(o)];case 4:return d.sent(),f?[4,this.setItemSize(h,e.Small)]:[3,6];case 5:d.sent(),f=!1,d.label=6;case 6:return[2]}}))}))},m=function(i,r,c,u){return void 0===u&&(u=null),s(A,void 0,void 0,(function(){var p,b,g=this;return a(this,(function(m){switch(m.label){case 0:return p=this.tab.groups[parseInt(n.toString(),10)],l||d[parseInt(i.toString(),10)].setAttribute("data-medium-width",o.offsetWidth.toString()),[4,(b=function(i){return s(g,void 0,void 0,(function(){var n;return a(this,(function(r){return(n=p.collections[parseInt(i.toString(),10)]).items[0].displayOptions&t.Classic&&(n.items[0].activeSize=e.Small,h.find((function(e){return e.id===n.items[0].id}))||(h.push(n.items[0]),f=!0)),[2]}))}))})(r)];case 1:return m.sent(),u?[4,b(u)]:[3,3];case 2:m.sent(),m.label=3;case 3:return[4,b(c)];case 4:return m.sent(),f?[4,this.setItemSize(h,e.Small)]:[3,6];case 5:m.sent(),f=!1,m.label=6;case 6:return[2]}}))}))},y=function(e){return s(A,void 0,void 0,(function(){var t;return a(this,(function(i){return(t=o.querySelector("#"+e))&&t.setAttribute("data-medium-width",o.offsetWidth.toString()),[2]}))}))},"Column"!==u)return[3,17];if(!(d.length>0))return[3,7];x=d.length-1,E.label=1;case 1:return x>=0?(w=parseInt(d[parseInt(x.toString(),10)].getAttribute("data-start"),10),C=parseInt(d[parseInt(x.toString(),10)].getAttribute("data-end"),10),L=this.checkClassicCollection(c.collections,w+1,!1),b(c.collections[parseInt(w.toString(),10)].items[0])&&b(c.collections[parseInt(L.toString(),10)].items[0])?C!==L?[3,3]:[4,m(x,w,C)]:[3,6]):[3,7];case 2:return E.sent(),[3,5];case 3:return b(c.collections[parseInt(C.toString(),10)].items[0])?[4,m(x,w,C,L)]:[3,5];case 4:E.sent(),E.label=5;case 5:if(!l&&r.offsetWidth>o.offsetWidth)return[2,!0];E.label=6;case 6:return x--,[3,1];case 7:x=c.collections.length-1,E.label=8;case 8:if(!(x>=0))return[3,16];for(T=c.collections[parseInt(x.toString(),10)],v=[],S=0;S<T.items.length;S++)T.items[parseInt(S.toString(),10)].displayOptions&t.Classic&&v.push(S);return v.length>1&&(b(T.items[v[0]])&&b(T.items[v[1]]))?(I=!0,2!==v.length?[3,11]:[4,y(T.id)]):[3,15];case 9:return E.sent(),[4,g(x,v[0],v[1])];case 10:return E.sent(),[3,14];case 11:return b(T.items[v[2]])?[4,y(T.id)]:[3,14];case 12:return E.sent(),[4,g(x,v[0],v[2],v[1])];case 13:E.sent(),E.label=14;case 14:if(!l&&(r.offsetWidth>o.offsetWidth||I))return I=!1,[2,!0];E.label=15;case 15:return x--,[3,8];case 16:return[3,34];case 17:if(!this.checkValidCollectionLength(c.collections))return[3,27];if(!(d.length>0))return[3,26];x=d.length-1,E.label=18;case 18:return x>=0?(k=d[parseInt(x.toString(),10)],w=parseInt(k.getAttribute("data-start"),10),C=parseInt(k.getAttribute("data-end"),10),T=c.collections[0],L=this.checkClassicItem(T.items,w+1,!1),b(c.collections[0].items[parseInt(w.toString(),10)])&&b(c.collections[0].items[parseInt(L.toString(),10)])?C!==L?[3,21]:[4,y(k.id)]:[3,25]):[3,26];case 19:return E.sent(),[4,g(0,w,C)];case 20:return E.sent(),[3,24];case 21:return b(c.collections[0].items[parseInt(C.toString(),10)])?[4,y(k.id)]:[3,24];case 22:return E.sent(),[4,g(0,w,C,L)];case 23:E.sent(),E.label=24;case 24:if(!l&&r.offsetWidth>o.offsetWidth)return[2,!0];E.label=25;case 25:return x--,[3,18];case 26:return[3,34];case 27:x=c.collections.length-1,E.label=28;case 28:if(!(x>=0))return[3,34];T=c.collections[parseInt(x.toString(),10)],L=T.items.length-1,E.label=29;case 29:return L>=0?(L=this.checkClassicItem(T.items,L,!1))<0?[3,32]:(q=T.items[parseInt(L.toString(),10)],b(q)?[4,y(q.id)]:[3,32]):[3,33];case 30:return E.sent(),[4,g(x,L,L)];case 31:if(E.sent(),!l&&r.offsetWidth>o.offsetWidth)return[2,!0];E.label=32;case 32:return L--,[3,29];case 33:return x--,[3,28];case 34:return[2,!1]}}))}))},n.prototype.checkSmallToMedium=function(i,n,r,o,l,c){return s(this,void 0,void 0,(function(){var u,p,d,h,f,b,g,m,y,v,S,I,k,w,C,x,T,L,q,A,E,O,P=this;return a(this,(function(M){switch(M.label){case 0:if(u=i.groups[parseInt(n.toString(),10)],p=u.orientation,d=o.querySelector("#"+u.id),h=[],b=d.querySelectorAll(".e-ribbon-shrink"),g=function(t){return t.allowedSizes&e.Medium&&t.activeSize===e.Small},m=function(i,r){return s(P,void 0,void 0,(function(){var o,s;return a(this,(function(a){return o=this.tab.groups[parseInt(n.toString(),10)].collections[parseInt(i.toString(),10)],(s=o.items[parseInt(r.toString(),10)]).displayOptions&t.Classic&&(s.activeSize=e.Medium,h.find((function(e){return e.id===s.id}))||(h.push(s),f=!0)),[2]}))}))},y=function(i){return s(P,void 0,void 0,(function(){var r;return a(this,(function(o){return r=this.tab.groups[parseInt(n.toString(),10)].collections,r[parseInt(i.toString(),10)].items[0].displayOptions&t.Classic&&(r[parseInt(i.toString(),10)].items[0].activeSize=e.Medium,h.find((function(e){return e.id===r[parseInt(i.toString(),10)].items[0].id}))||(h.push(r[parseInt(i.toString(),10)].items[0]),f=!0)),[2]}))}))},"Row"!==p)return[3,10];if(this.checkValidCollectionLength(u.collections))return[3,9];w=0,M.label=1;case 1:if(!(w<u.collections.length))return[3,7];A=u.collections[parseInt(w.toString(),10)],E=0,M.label=2;case 2:return E<A.items.length?(E=this.checkClassicItem(A.items,E,!0))===A.items.length?[3,5]:(v=A.items[parseInt(E.toString(),10)],g(v)?(S=o.querySelector("#"+v.id),"GroupButton"===v.type&&(S=o.querySelector("#"+v.id+"_grpbtn")),x=S.getAttribute("data-medium-width"),(T=x?parseInt(x,10):null)&&(l||r.offsetWidth>T)?[4,m(w,E)]:[3,4]):[3,5]):[3,6];case 3:return M.sent(),l&&!c||S.removeAttribute("data-medium-width"),[3,5];case 4:if(T)return[2,!0];M.label=5;case 5:return E++,[3,2];case 6:return w++,[3,1];case 7:return f?[4,this.setItemSize(h,e.Medium)]:[3,9];case 8:M.sent(),f=!1,M.label=9;case 9:return[3,20];case 10:w=0,M.label=11;case 11:if(!(w<u.collections.length))return[3,18];if(!(u.collections[parseInt(w.toString(),10)].items.length>1))return[3,17];for(A=u.collections[parseInt(w.toString(),10)],S=o.querySelector("#"+A.id),x=S.getAttribute("data-medium-width"),T=x?parseInt(x,10):null,I=[],k=0;k<A.items.length;k++)A.items[parseInt(k.toString(),10)].displayOptions&t.Classic&&I.push(k);return I.length>1&&T&&(l||r.offsetWidth>T)?[4,m(w,I[0])]:[3,16];case 12:return M.sent(),[4,m(w,I[1])];case 13:return M.sent(),3!==I.length?[3,15]:[4,m(w,I[2])];case 14:M.sent(),M.label=15;case 15:return l&&!c||S.removeAttribute("data-medium-width"),[3,17];case 16:if(T)return[2,!0];M.label=17;case 17:return w++,[3,11];case 18:return f?[4,this.setItemSize(h,e.Medium)]:[3,20];case 19:M.sent(),f=!1,M.label=20;case 20:if(!(b.length>0))return[3,35];w=0,M.label=21;case 21:return w<b.length?(C=b[parseInt(w.toString(),10)],x=C.getAttribute("data-medium-width"),(T=x?parseInt(x,10):null)&&(l||r.offsetWidth>T)?(L=parseInt(C.getAttribute("data-start"),10),q=parseInt(C.getAttribute("data-end"),10),"Row"!==p?[3,26]:(A=u.collections[0],E=this.checkClassicItem(A.items,L+1,!0),[4,m(0,L)])):[3,31]):[3,33];case 22:return M.sent(),[4,m(0,E)];case 23:return M.sent(),E===q?[3,25]:[4,m(0,q)];case 24:M.sent(),M.label=25;case 25:return[3,30];case 26:return O=this.checkClassicCollection(u.collections,L+1,!0),[4,y(L)];case 27:return M.sent(),[4,y(O)];case 28:return M.sent(),O===q?[3,30]:[4,y(q)];case 29:M.sent(),M.label=30;case 30:return l&&!c||C.removeAttribute("data-medium-width"),[3,32];case 31:if(T)return[2,!0];M.label=32;case 32:return w++,[3,21];case 33:return f?[4,this.setItemSize(h,e.Medium)]:[3,35];case 34:M.sent(),f=!1,M.label=35;case 35:return[2,!1]}}))}))},n.prototype.checkMediumToLarge=function(i,n,r,o,l,c){return s(this,void 0,void 0,(function(){var u,p,d,h,f,b,g,m,y,v,S,I,k,w,C,x,T,L,q,A=this;return a(this,(function(E){switch(E.label){case 0:if(u=i.groups[parseInt(n.toString(),10)],p=u.orientation,d=[],h=[],f=[],g=o.querySelector("#"+u.id),0===(m=g.querySelectorAll(".e-ribbon-shrink")).length)return[2,!1];y=function(i,r,o){return s(A,void 0,void 0,(function(){var u,p,d,f=this;return a(this,(function(g){switch(g.label){case 0:return u=this.tab.groups[parseInt(n.toString(),10)].collections[0],p=this.tab.groups[parseInt(n.toString(),10)].collections[0].items,[4,(d=function(i){return s(f,void 0,void 0,(function(){var n;return a(this,(function(r){return(n=p[parseInt(i.toString(),10)]).displayOptions&t.Classic&&(n.activeSize=e.Large,p.find((function(e){return e.id===n.id}))||p.push(n),h.push(n.id),b=!0),[2]}))}))})(i)];case 1:return g.sent(),o?[4,d(o)]:[3,3];case 2:g.sent(),g.label=3;case 3:return[4,d(r)];case 4:return g.sent(),b?[4,this.dotNetRef.invokeMethodAsync("UpdateShrinkable",!1,h,null)]:[3,7];case 5:return g.sent(),[4,this.setItemSize(p,e.Large)];case 6:g.sent(),b=!1,g.label=7;case 7:return l&&!c?[3,9]:[4,this.dotNetRef.invokeMethodAsync("CreateShrinkContainer",null,null,null,u.id,null,!0)];case 8:g.sent(),g.label=9;case 9:return[2]}}))}))},v=function(i,r,o,p){return s(A,void 0,void 0,(function(){var h,g,m=this;return a(this,(function(y){switch(y.label){case 0:return h=this.tab.groups[parseInt(n.toString(),10)].collections,[4,(g=function(i){return s(m,void 0,void 0,(function(){var n;return a(this,(function(r){return(n=h[parseInt(i.toString(),10)]).items[0].displayOptions&t.Classic&&(n.items[0].activeSize=e.Large,h.find((function(e){return e.id===n.id}))||f.push(n.id),d.find((function(e){return e.id===n.items[0].id}))||d.push(n.items[0]),b=!0),[2]}))}))})(i)];case 1:return y.sent(),p?[4,g(p)]:[3,3];case 2:y.sent(),y.label=3;case 3:return[4,g(r)];case 4:return y.sent(),b?[4,this.dotNetRef.invokeMethodAsync("UpdateShrinkable",!1,null,f)]:[3,7];case 5:return y.sent(),[4,this.setItemSize(d,e.Large)];case 6:y.sent(),b=!1,y.label=7;case 7:return l&&!c?[3,9]:(sf.base.remove(o),[4,this.dotNetRef.invokeMethodAsync("CreateShrinkContainer",null,null,null,null,u.id,!0)]);case 8:y.sent(),y.label=9;case 9:return[2]}}))}))},S=0,E.label=1;case 1:return S<m.length?(I=m[parseInt(S.toString(),10)],k=I.getAttribute("data-large-width"),(w=k?parseInt(k,10):null)&&(l||r.offsetWidth>w)?(C=parseInt(I.getAttribute("data-start"),10),x=parseInt(I.getAttribute("data-end"),10),"Row"!==p?[3,6]:(T=u.collections[0],(L=this.checkClassicItem(T.items,C+1,!0))!==x?[3,3]:[4,y(C,x)])):[3,11]):[3,13];case 2:return E.sent(),[3,5];case 3:return[4,y(C,x,L)];case 4:E.sent(),E.label=5;case 5:return[3,10];case 6:return(q=this.checkClassicCollection(u.collections,C+1,!0))!==x?[3,8]:[4,v(C,x,I)];case 7:return E.sent(),[3,10];case 8:return[4,v(C,x,I,q)];case 9:E.sent(),E.label=10;case 10:return l&&!c||I.removeAttribute("data-large-width"),[3,12];case 11:if(w)return[2,!0];E.label=12;case 12:return S++,[3,1];case 13:return b?[4,this.setItemSize(d,e.Large)]:[3,15];case 14:E.sent(),b=!1,E.label=15;case 15:return[2,!1]}}))}))},n.prototype.createOverflowDropdown=function(e,t){return s(this,void 0,void 0,(function(){var i,n,o,s;return a(this,(function(l){switch(l.label){case 0:if(0===(i=this.getGroupResizeOrder(!0)).length)return[2];n=function(n){var s,l,c;return a(this,(function(a){switch(a.label){case 0:return s=i[parseInt(n.toString(),10)],o.element.querySelector("#"+s.id).setAttribute("data-expanded-width",t.offsetWidth.toString()),l=r(o.tab.groups,(function(e){return e.id===s.id})),c=o.tab,[4,o.checkSmallToMedium(c,l,e,t,!0,!1)];case 1:return a.sent(),[4,o.checkMediumToLarge(c,l,e,t,!0,!1)];case 2:return a.sent(),[4,o.dotNetRef.invokeMethodAsync("ToggleOverflowDropDown",!0,s.id,null,!1,!1)];case 3:return a.sent(),o.tab.groups[parseInt(l.toString(),10)].isCollapsed=!0,[2]}}))},o=this,s=0,l.label=1;case 1:return s<i.length&&e.offsetWidth<t.offsetWidth?[5,n(s)]:[3,4];case 2:l.sent(),l.label=3;case 3:return s++,[3,1];case 4:return[2]}}))}))},n.prototype.removeOverflowDropdown=function(e,t,n){return void 0===n&&(n=!1),s(this,void 0,void 0,(function(){var o,s,l,c,u;return a(this,(function(p){switch(p.label){case 0:if(0===(o=this.getGroupResizeOrder(!1)).length)return[2,!1];s=function(i){var s,c,u,p,d;return a(this,(function(a){switch(a.label){case 0:return s=o[parseInt(i.toString(),10)],(c=l.element.querySelector("#"+s.id))?(u=parseInt(c.getAttribute("data-expanded-width"),10),!n&&e.offsetWidth<u?[2,{value:!0}]:(p=r(l.tab.groups,(function(e){return e.id===s.id})),[4,l.dotNetRef.invokeMethodAsync("ToggleOverflowDropDown",!1,s.id,null,!1,!1)])):[2,"break"];case 1:return a.sent(),d=l.tab,[4,l.checkLargeToMedium(d,p,e,t,!0)];case 2:return a.sent(),[4,l.checkMediumToSmall(d,p,e,t,!0)];case 3:return a.sent(),l.tab.groups[parseInt(p.toString(),10)].isCollapsed=!1,[2]}}))},l=this,c=0,p.label=1;case 1:return c<o.length?[5,s(c)]:[3,4];case 2:if("object"===i(u=p.sent()))return[2,u.value];if("break"===u)return[3,4];p.label=3;case 3:return c++,[3,1];case 4:return[2,!1]}}))}))},n.prototype.getGroupResizeOrder=function(e){var t=this,i=this.tab.groups;return(i=i.filter((function(i){return"Classic"!==t.activeLayout||(sf.base.isUndefined(i.isCollapsible)||i.isCollapsible)&&(e&&sf.base.isUndefined(i.isCollapsed)||!sf.base.isUndefined(i.isCollapsed)&&e!==i.isCollapsed)}))).sort((function(e,t){return e.priority-t.priority})),e?i.reverse():i},n.prototype.checkSimplifiedItemShrinking=function(i,n){return s(this,void 0,void 0,(function(){var r,o,s,l,c,u,p,d,h,f;return a(this,(function(a){switch(a.label){case 0:for(r=this.tab,o=[],l=r.groups.length-1;l>=0;l--)for(c=r.groups[parseInt(l.toString(),10)],u=i.querySelector("#"+c.id+"_container"),p=0;p<c.collections.length&&i.offsetWidth<n.offsetWidth;p++)for(d=c.collections[parseInt(p.toString(),10)],h=function(i){var r=d.items[i-1];if(r.allowedSizes&e.Small&&r.allowedSizes&e.Medium&&r.activeSize===e.Medium&&r.displayOptions&t.Simplified){var a=u.querySelector("#"+r.id+"_container");a&&(a.setAttribute("data-medium-width",n.offsetWidth.toString()),r.activeSize=e.Small,o.find((function(e){return e.id===r.id}))||(o.push(r),s=!0))}},f=d.items.length;f>=1&&i.offsetWidth<n.offsetWidth;f--)h(f);return s?[4,this.setItemSize(o,e.Small)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},n.prototype.checkSimplifiedItemExpanding=function(i,n){return s(this,void 0,void 0,(function(){var r,o,s,l,c,u,p,d,h,f;return a(this,(function(a){switch(a.label){case 0:for(r=this.tab,o=[],l=r.groups.length-1;l>=0;l--)for(c=r.groups[parseInt(l.toString(),10)],u=i.querySelector("#"+c.id+"_container"),p=0;p<c.collections.length&&i.offsetWidth>n.offsetWidth;p++)for(d=c.collections[parseInt(p.toString(),10)],h=function(n){var r=d.items[n-1];if(r.allowedSizes&e.Small&&r.allowedSizes&e.Medium&&r.activeSize===e.Small&&r.displayOptions&t.Simplified){var a=u.querySelector("#"+r.id+"_container");if(a){var l=a.getAttribute("data-medium-width"),c=l?parseInt(l,10):null;c&&i.offsetWidth>c&&(a.removeAttribute("data-medium-width"),r.activeSize=e.Medium,o.find((function(e){return e.id===r.id}))||(o.push(r),s=!0))}}},f=d.items.length;f>=1&&i.offsetWidth>n.offsetWidth;f--)h(f);return s?[4,this.setItemSize(o,e.Medium)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},n.prototype.createSimplifiedOverflow=function(i,n){return s(this,void 0,void 0,(function(){var r,o,s,l,c,u,p,d,h,f,b,g;return a(this,(function(m){switch(m.label){case 0:r=this.getGroupResizeOrder(!0),o=[],l=0,m.label=1;case 1:if(!(l<r.length&&i.offsetWidth<n.offsetWidth))return[3,9];c=r[parseInt(l.toString(),10)],u=i.querySelector("#"+c.id),p=c.collections.length,m.label=2;case 2:if(!(p>=1&&i.offsetWidth<n.offsetWidth))return[3,7];d=c.collections[parseInt((p-1).toString(),10)],h=u.querySelector("#"+d.id),f=function(i){var r,l;return a(this,(function(a){switch(a.label){case 0:return r=d.items[i-1],l=h.querySelector("#"+r.id+"_container"),r.displayOptions!==t.Auto&&r.displayOptions!==(t.Simplified|t.Overflow)||sf.base.isNullOrUndefined(l)?[3,3]:(l.setAttribute("data-simplified-width",n.offsetWidth.toString()),[4,b.dotNetRef.invokeMethodAsync("UpdateDataAttribute",r.id,n.offsetWidth.toString(),!0)]);case 1:return a.sent(),r.activeSize===e.Small&&(r.activeSize=e.Medium,o.find((function(e){return e.id===r.id}))||(o.push(r),s=!0)),[4,b.dotNetRef.invokeMethodAsync("ToggleOverflowDropDown",!0,c.id,r.id,!1,!1)];case 2:a.sent(),a.label=3;case 3:return[2]}}))},b=this,g=d.items.length,m.label=3;case 3:return g>=1&&i.offsetWidth<n.offsetWidth?[5,f(g)]:[3,6];case 4:m.sent(),m.label=5;case 5:return g--,[3,3];case 6:return p--,[3,2];case 7:c.enableGroupOverflow||u.querySelector(".e-ribbon-item")||u.classList.add("e-ribbon-emptyCollection"),m.label=8;case 8:return l++,[3,1];case 9:return s?[4,this.setItemSize(o,e.Medium)]:[3,11];case 10:m.sent(),m.label=11;case 11:return[2]}}))}))},n.prototype.removeSimplifiedOverflow=function(i,n,r){return void 0===r&&(r=!1),s(this,void 0,void 0,(function(){var o,s,l,c,u,p,d,h,f,b,g,m;return a(this,(function(a){switch(a.label){case 0:for(o=this.getGroupResizeOrder(!1),s=!0,l=[],c=[],p=0;p<o.length&&s;p++)for(d=o[parseInt(p.toString(),10)],h=d.enableGroupOverflow?this.element.querySelector(".e-ribbon-group-overflow-popup."+d.id):this.element.querySelector(".e-ribbon-overall-overflow-popup"),f=0;f<d.collections.length&&s;f++)for(b=d.collections[parseInt(f.toString(),10)],g=function(o){var a=b.items[parseInt(o.toString(),10)],p=void 0;if(h&&(p=h.querySelector("#"+a.id+"_container")),(a.displayOptions===t.Auto||a.displayOptions===(t.Simplified|t.Overflow))&&!sf.base.isNullOrUndefined(p)){var f=parseInt(p.getAttribute("data-simplified-width"),10),g=i.querySelector("#"+d.id);if((p.classList.contains("e-hidden")||g.classList.contains("e-hidden"))&&(f=Math.abs(f-n.offsetWidth)),!r&&i.offsetWidth<f)return s=!1,"break";a.allowedSizes&e.Small&&(a.activeSize=e.Small,l.find((function(e){return e.id===a.id}))||(l.push(a),u=!0));var m=h.querySelectorAll(".e-ribbon-item").length>1;c.push({groupId:d.id,itemId:a.id,value:!1,isItem:m})}},m=0;m<b.items.length&&s&&!r&&i.offsetWidth>n.offsetWidth&&"break"!==g(m);m++);return c.length>0?[4,this.dotNetRef.invokeMethodAsync("ToggleOverflowDropdownsInBulk",JSON.stringify(c))]:[3,2];case 1:a.sent(),a.label=2;case 2:return u?[4,this.setItemSize(l,e.Small)]:[3,4];case 3:a.sent(),a.label=4;case 4:return[2]}}))}))},n.prototype.setInitialValues=function(){this.currentControlIndex=0,this.element.style.setProperty("--fileMenuWidth","0px"),this.element.style.setProperty("--helpTemplateWidth","0px");var e=this.element.querySelector(".e-tab.e-ribbon-tab");setTimeout((function(){e.querySelector(".e-toolbar").style.width="calc(100% - var(--fileMenuWidth) - var(--helpTemplateWidth))"}),100);var t=document.querySelector(".e-ribbon-backstage"),i=document.querySelector(".e-dropdown-btn.e-ribbon-file-menu");e&&e.style.setProperty("--fileMenuWidth",(t?t.offsetWidth:i.offsetWidth)+"px")},n.prototype.createBackstagePopup=function(e){var t=document.querySelector("#"+e.target);this.backstagePopupElement=this.element.querySelector(".e-ribbon-backstage-popup"),this.backstagePopupObj=new sf.popups.Popup(this.backstagePopupElement,{relateTo:t||this.element,enableRtl:e.enableRtl,width:e.width,height:e.height}),this.backstagePopupObj.hide()},n.prototype.backstageDocClickHandler=function(e){return s(this,void 0,void 0,(function(){var t;return a(this,(function(i){switch(i.label){case 0:return t=e.target,!this.backstagePopupElement||t&&this.backstagePopupElement.contains(t)?[2]:[3,1];case 1:return this.hideBackstagePopup(),[4,this.dotNetRef.invokeMethodAsync("UpdateBackstageClosingState")];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))},n.prototype.showHideBackstagePopup=function(e){if(this.backstagePopupElement)if(e.isShowPopup){this.backstagePopupElement&&(sf.base.EventHandler.add(this.backstagePopupElement,"keydown",this.handleBackstageNavigation.bind(this),this),sf.base.EventHandler.add(document,"click",this.backstageDocClickHandler,this)),this.backstagePopupElement.classList.add("e-ribbon-backstage-open"),this.backstagePopupElement.classList.remove("e-ribbon-backstage-close"),this.backstagePopupObj.show(),this.isCloseBtn=!1,this.menuIndex=0;var t=this.backstagePopupElement.querySelector(".e-menu").querySelector(".e-menu-item.e-selected");t&&t.focus()}else this.hideBackstagePopup()},n.prototype.hideBackstagePopup=function(){this.backstagePopupElement&&(sf.base.EventHandler.remove(this.backstagePopupElement,"keydown",this.handleBackstageNavigation.bind(this)),sf.base.EventHandler.remove(document,"click",this.backstageDocClickHandler)),this.backstagePopupElement.classList.add("e-ribbon-backstage-close"),this.backstagePopupElement.classList.remove("e-ribbon-backstage-open"),this.backstagePopupObj&&this.backstagePopupObj.hide()},n.prototype.createGalleryPopup=function(e){return s(this,void 0,void 0,(function(){var t,i,n,r,o,l=this;return a(this,(function(c){return t=document.querySelector("#"+e.itemId+"_popupContainer"),(i=document.querySelector("#"+e.itemId+"_galleryPopup"))&&i.remove(),n=document.querySelector("#"+e.itemId+"_popupButton"),r=sf.base.createElement("div",{className:"e-ribbon-gallery-popup",id:e.itemId+"_galleryPopup"}),document.body.append(r),t&&(t.style.display="block"),(o=new sf.popups.Popup(r,{relateTo:n,content:t,collision:{X:"fit",Y:"flip"},actionOnScroll:"hide",targetType:"relative",position:{X:"left",Y:"bottom"},enableRtl:e.enableRtl,width:e.popupWidth,height:e.popupHeight})).hide(),setTimeout((function(){return s(l,void 0,void 0,(function(){var t=this;return a(this,(function(i){switch(i.label){case 0:return[4,this.checkAvailableHeight(e)];case 1:return i.sent(),r.onkeydown=function(i){t.handleGalleryPopupNavigation(i,r,e.itemId,o)},[2]}}))}))}),50),[2]}))}))},n.prototype.setGalleryPopupHeight=function(e,t,i){window.innerHeight<t||window.innerHeight<Math.round(t+i)?e.style.height=window.innerHeight-i+"px":e.style.height="auto"},n.prototype.setWrapperWidth=function(e,t,i,n){for(var r=1,o=0,s=!1,a=0;a<i.length;a++){for(var l=0;l<i[parseInt(a.toString(),10)].items.length;l++){if(!(e>=r)){s=!0;break}var c=t.querySelector("#"+n+"_galleryContainer"+a+"_gallery"+l);if(c){o+=c.offsetWidth;var u=window.getComputedStyle(c);if(u){var p=parseFloat(u.paddingLeft)+parseFloat(u.paddingRight);sf.base.isNullOrUndefined(p)||(o+=p);var d=parseFloat(u.marginLeft)+parseFloat(u.marginRight);sf.base.isNullOrUndefined(d)||(o+=d)}}r++}if(s)break}o>0&&(t.style.width=o+"px")},n.prototype.switchGalleryItems=function(e){var t=this.element.querySelector("#"+e.itemId+"_container");if(t){var i=t.querySelectorAll(".e-ribbon-gallery-icons"),n=t.querySelectorAll(".e-ribbon-gallery-container");if(i.length)for(var r=0;r<i.length;r++)"Simplified"===e.activeLayout?i[parseInt(r.toString(),10)].classList.add("e-hidden"):i[parseInt(r.toString(),10)].classList.remove("e-hidden");if(n.length&&e)for(var o=0;o<e.groups.length;o++)for(r=0;r<n.length;r++)e.groups[parseInt(o.toString(),10)].itemHeight&&"auto"!==e.groups[parseInt(o.toString(),10)].itemHeight&&e.itemId+"_galleryContainer"+o===n[parseInt(r.toString(),10)].id&&("Simplified"===e.activeLayout?n[parseInt(r.toString(),10)].style.flexFlow="nowrap":n[parseInt(r.toString(),10)].style.flexFlow="wrap");null!=e&&this.checkAvailableHeight(e)}},n.prototype.checkGalleryItemsCollision=function(e,t,i){void 0===i&&(i=0);var n=0,r=0;if(t){var o=window.innerWidth,s=0===i?o:Math.abs(o-(o-i)),a=window.getComputedStyle(t);a&&(n=parseFloat(a.paddingLeft)+parseFloat(a.paddingRight),sf.base.isNullOrUndefined(n)||(s-=n));var l=t.querySelectorAll(".e-ribbon-gallery-container");"auto"!==e.width&&l.forEach((function(e){e.style.flexFlow="wrap"}));for(var c=!1,u=0;u<l.length;u++){for(var p=0,d=0;d<l[parseInt(u.toString(),10)].querySelectorAll(".e-ribbon-gallery-item").length;d++){var h=window.getComputedStyle(l[parseInt(u.toString(),10)].querySelectorAll(".e-ribbon-gallery-item")[parseInt(d.toString(),10)]);if(h&&(r=parseFloat(h.marginLeft)+parseFloat(h.marginRight),sf.base.isNullOrUndefined(r)||(p+=r)),s<=(p+=Math.round(parseFloat(h.width)))&&"auto"===e.width||"auto"!==e.width&&s<=parseInt(e.width.toString(),10)&&s<=p){t.style.width=p+Math.abs(n-r)-Math.round(parseFloat(h.width))+"px",c=!0;break}}if(c){l.forEach((function(e){e.style.flexFlow="wrap"})),"auto"===e.height&&this.setGalleryPopupHeight(t,parseFloat(a.height),parseFloat(a.top));break}}c||("auto"===e.width?(l.forEach((function(e){e.style.flexFlow="nowrap"})),t.style.width="auto"):t.style.width=e.width.toString(),"auto"===e.height&&this.setGalleryPopupHeight(t,parseFloat(a.height),parseFloat(a.top)))}},n.prototype.checkAvailableHeight=function(e){return s(this,void 0,void 0,(function(){var t,i,n,r,o,s,l,c,u,p,d,h,f,b,g,m;return a(this,(function(a){switch(a.label){case 0:if(!(t=this.element.querySelector("#"+e.tabId+"_content")))return[2];i=t.querySelectorAll(".e-ribbon-gallery-wrapper"),n=0,a.label=1;case 1:if(!(n<i.length))return[3,4];if(r=0,o=0,s=!1,l=i[parseInt(n.toString(),10)],c=l.id.replace(/_galleryWrapper/g,""),u=l.offsetHeight,!e.groups||!e.itemCount)return[3,3];for(this.setWrapperWidth(e.itemCount,l,e.groups,c),p=[],d=0;d<e.groups.length;d++)for(h=0;h<e.groups[parseInt(d.toString(),10)].items.length;h++)(f=l.querySelector("#"+c+"_galleryContainer"+d+"_gallery"+h))&&("Classic"===e.activeLayout?(f.classList.contains("e-hidden")&&f.classList.remove("e-hidden"),s?f.remove():(b=0,(g=window.getComputedStyle(f))&&(m=parseFloat(g.marginTop)+parseFloat(g.marginBottom),sf.base.isNullOrUndefined(m)||(b+=m)),r++,e.itemCount===r?(r=0,u>=f.offsetHeight+b?u-=f.offsetHeight+b:(s=!0,f.remove())):u<f.offsetHeight+b&&(s=!0,f.remove()))):++o>e.itemCount&&(f.classList.add("e-hidden"),p.push(f.id)));return[4,this.dotNetRef.invokeMethodAsync("UpdateGalleryHiddenItems",p)];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},n.prototype.refreshGalleryPopupPosition=function(e,t,i,n){if(t){this.checkGalleryItemsCollision(i,t);var r=void 0;n?(r=document.querySelector("#"+e+"_gallery_dropdown_btn"),t.style.zIndex=sf.popups.getZindexPartial(t).toString()):((r=document.querySelector("#"+e+"_popupButton")).classList.add("e-gallery-button-active"),t.style.zIndex="1002");var o=r.getBoundingClientRect();t.offsetWidth>o.left&&this.checkGalleryItemsCollision(i,t,o.left);var s=Math.abs(t.offsetWidth-o.left),a=n?s:s+r.offsetWidth,l=n?r.offsetHeight:t.getBoundingClientRect().top;t.style.left=a+"px",t.style.top=l+2+"px",this.galleryItemsIndex=0;var c=t.querySelectorAll(".e-ribbon-gallery-item")[0];c&&c.focus()}},n.prototype.showHideGalleryPopup=function(e){var t=document.querySelector("#"+e.itemId+"_galleryPopup");if(t){var i=sf.base.getComponent(t,sf.popups.Popup);t.classList.contains("e-popup-close")?(i.show(),this.refreshGalleryPopupPosition(e.itemId,t,i,e.isSimplifiedOverflow),sf.base.EventHandler.add(document,"click",this.galleryDocClickHandler,this)):this.hidePopup(i,e.itemId)}},n.prototype.hidePopup=function(e,t,i){return void 0===i&&(i=null),s(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return n=!1,null==i?[3,2]:[4,this.dotNetRef.invokeMethodAsync("GalleryPopupDocumentClickHandler",i,t)];case 1:n=r.sent(),r.label=2;case 2:return n||(sf.base.EventHandler.remove(document,"click",this.galleryDocClickHandler),e.hide(),document.querySelector("#"+t+"_popupButton").classList.remove("e-gallery-button-active")),[2]}}))}))},n.prototype.galleryDocClickHandler=function(e){for(var t,i=document.querySelectorAll(".e-ribbon-gallery-popup.e-popup-open"),n=e.target,r=0;r<i.length;r++){var o=sf.base.getComponent(i[parseInt(r.toString(),10)],sf.popups.Popup);if(!n.classList.contains("e-ribbon-gallery-button")&&!n.classList.contains("e-ribbon-gallery-dropdown")){t=i[parseInt(r.toString(),10)].id.replace(/_galleryPopup/g,""),this.hidePopup(o,t,e);break}t=i[parseInt(r.toString(),10)].id.replace(/_galleryPopup/g,"");var s=n.id.replace(/_popupButton/g,""),a=n.id.replace(/_gallery_dropdown_btn/g,"");if((n.classList.contains("e-ribbon-gallery-dropdown")?a:s)!==t){this.hidePopup(o,t,e);break}}},n.prototype.ribbonPropsUpdate=function(e){this.updateContext(e),this.setInitialValues()},n.prototype.destroyScroll=function(){this.scrollModule&&(this.scrollModule.destroy(),this.scrollModule=null)},n.prototype.destroy=function(){this.unWireEvents(),this.keyboardModuleRibbon.destroy(),this.keyboardModuleRibbon=null,this.scrollModule&&(this.scrollModule.destroy(),this.scrollModule=null),this.element=null,this.backstagePopupElement=null,this.backstagePopupObj=null,this.tab=null,this.activeLayout=null,this.menuIndex=null,this.isSizeReducedAtleastOnce=null,this.currentControlIndex=null,this.galleryItemsIndex=null,this.itemIndex=null,this.keyConfigs=null,this.keyTipElements=null},n}();return{initialize:function(e){e.dataId&&new l(e)},updateRibbonProps:function(e){window.sfBlazor.getCompInstance(e.dataId).ribbonPropsUpdate(e)},refreshLayout:function(e){window.sfBlazor.getCompInstance(e.dataId).resizeHandler()},createBackstagePopup:function(e){window.sfBlazor.getCompInstance(e.dataId).createBackstagePopup(e)},showHideBackstagePopup:function(e){window.sfBlazor.getCompInstance(e.dataId).showHideBackstagePopup(e)},createGalleryPopup:function(e){window.sfBlazor.getCompInstance(e.dataId).createGalleryPopup(e)},showHideGalleryPopup:function(e){window.sfBlazor.getCompInstance(e.dataId).showHideGalleryPopup(e)},switchGalleryItems:function(e){window.sfBlazor.getCompInstance(e.dataId).switchGalleryItems(e)},bindOrUnbindOverflowKeyDown:function(e){window.sfBlazor.getCompInstance(e.dataId).bindOrUnBindKeyDownEventOnOverflowTarget(e)},bindOrUnbindOverflowClick:function(e){window.sfBlazor.getCompInstance(e.dataId).bindOrUnBindClickEventOnOverflowTarget(e)},showHideKeyTips:function(e){window.sfBlazor.getCompInstance(e.dataId).showHideKeyTips(e)},destroy:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.destroy()}}}()}}]);(async()=>{await import(`${document.baseURI}_content/Syncfusion.Blazor/scripts/syncfusion-blazor-base.min.js?v=29.2.undefined`).then(()=>{sfBlazor.loadDependencies('sfribbon');})})();